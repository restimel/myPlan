import{t as ye,r as ge,a as g,c as Ve,s as P,i as ke,w as C,b as Ce,d as L,g as we,o as xe,e as p,f as Se,h as $e,u as c,j as Ie,k as w,l as _,n as D,m as S,p as d,q as m,v as f,_ as R,x as b,y as I,M,T as Me,z as Te,A as Pe,B as te,C as $,D as ne,E as k,F as K,G as Re,H as O,I as Ee,J as Le,K as We}from"./index-CsNnkh75.js";function oe(){return Math.round(Math.random()*2**50)}function G(e){return we()?(xe(e),!0):!1}const W=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Be=Object.prototype.toString,Ne=e=>Be.call(e)==="[object Object]",Ae=()=>{};function Ue(...e){if(e.length!==1)return ye(...e);const t=e[0];return typeof t=="function"?ge(Ve(()=>({get:t,set:Ae}))):g(t)}function j(e){return Array.isArray(e)?e:[e]}function De(e,t=1e3,n={}){const{immediate:i=!0,immediateCallback:o=!1}=n;let a=null;const r=P(!1);function l(){a&&(clearInterval(a),a=null)}function s(){r.value=!1,l()}function u(){const v=L(t);v<=0||(r.value=!0,o&&e(),l(),r.value&&(a=setInterval(e,v)))}if(i&&W&&u(),ke(t)||typeof t=="function"){const v=C(t,()=>{r.value&&W&&u()});G(v)}return G(s),{isActive:Ce(r),pause:s,resume:u}}function qe(e,t,n){return C(e,t,{...n,immediate:!0})}function Oe(e,t,n){return C(e,(o,a,r)=>{o&&t(o,a,r)},{...n,once:!1})}const je=W?window:void 0,ae=W?window.document:void 0,ie=W?window.navigator:void 0;function Fe(e){var t;const n=L(e);return(t=n==null?void 0:n.$el)!=null?t:n}function se(...e){const t=[],n=()=>{t.forEach(l=>l()),t.length=0},i=(l,s,u,v)=>(l.addEventListener(s,u,v),()=>l.removeEventListener(s,u,v)),o=p(()=>{const l=j(L(e[0])).filter(s=>s!=null);return l.every(s=>typeof s!="string")?l:void 0}),a=qe(()=>{var l,s;return[(s=(l=o.value)==null?void 0:l.map(u=>Fe(u)))!=null?s:[je].filter(u=>u!=null),j(L(o.value?e[1]:e[0])),j(c(o.value?e[2]:e[1])),L(o.value?e[3]:e[2])]},([l,s,u,v])=>{if(n(),!(l!=null&&l.length)||!(s!=null&&s.length)||!(u!=null&&u.length))return;const h=Ne(v)?{...v}:v;t.push(...l.flatMap(x=>s.flatMap(_e=>u.map(he=>i(x,_e,he,h)))))},{flush:"post"}),r=()=>{a(),n()};return G(n),r}function Ge(){const e=P(!1),t=$e();return t&&Se(()=>{e.value=!0},t),e}function le(e){const t=Ge();return p(()=>(t.value,!!e()))}function He(e={}){const{document:t=ae}=e;if(!t)return P("visible");const n=P(t.visibilityState);return se(t,"visibilitychange",()=>{n.value=t.visibilityState},{passive:!0}),n}function ze(e){const{pattern:t=[],interval:n=0,navigator:i=ie}=e||{},o=le(()=>typeof i<"u"&&"vibrate"in i),a=Ue(t);let r;const l=(u=a.value)=>{o.value&&i.vibrate(u)},s=()=>{o.value&&i.vibrate(0),r==null||r.pause()};return n>0&&(r=De(l,n,{immediate:!1,immediateCallback:!1})),{isSupported:o,pattern:t,intervalControls:r,vibrate:l,stop:s}}function Je(e={}){const{navigator:t=ie,document:n=ae}=e,i=P(!1),o=P(null),a=He({document:n}),r=le(()=>t&&"wakeLock"in t),l=p(()=>!!o.value&&a.value==="visible");r.value&&(se(o,"release",()=>{var h,x;i.value=(x=(h=o.value)==null?void 0:h.type)!=null?x:!1},{passive:!0}),Oe(()=>a.value==="visible"&&(n==null?void 0:n.visibilityState)==="visible"&&i.value,h=>{i.value=!1,s(h)}));async function s(h){var x;await((x=o.value)==null?void 0:x.release()),o.value=r.value?await t.wakeLock.request(h):null}async function u(h){a.value==="visible"?await s(h):i.value=h}async function v(){i.value=!1;const h=o.value;o.value=null,await(h==null?void 0:h.release())}return{sentinel:o,isSupported:r,isActive:l,request:u,forceRequest:s,release:v}}function Ke(){ue(1200,300,.4)}function Qe(){ue(1200,1e3,.6)}function ue(e=1e3,t=500,n=.2){const i=new(window.AudioContext||window.webkitAudioContext),o=i.createOscillator(),a=i.createGain();o.connect(a),a.connect(i.destination),o.type="sine",o.frequency.value=e,a.gain.value=n,o.start(),o.stop(i.currentTime+t/1e3)}const re=200,ce="default period",H={id:0,name:ce,duration:360,endEffect:"stop",activateSound:!0,activateVibration:!0,soundWarning:!0},y=g([]);Q(-1);function Q(e,t=H){const n=y.value,i={...t};return e>=0&&e<n.length?(n[e]=i,y.value=n,e):(i.id=oe(),i.name===ce&&(i.name=`period ${n.length+1}`),n.push(i),y.value=n,n.length-1)}function Xe(e){const t=y.value;return e>=0&&e<t.length?(t.splice(e,1),y.value=t,!0):!1}const z=g(0),V=p(()=>y.value[z.value]),T=p(()=>B.value!==0),N=g(0),de=p(()=>Math.floor(N.value/1e3)),B=g(0);let J=performance.now();const ve=p(()=>{const e=N.value;return V.value.duration*1e3-e}),Ye=p(()=>{const e=de.value;return V.value.duration-e}),q=p(()=>{const e=V.value.duration*1e3;return N.value>=e}),Ze=p(()=>{const e=ve.value;return pe(e)});function pe(e){return e>6e4?60:e>1e4?10:e>0?Math.floor(e/1e3):0}function me(e){const n=y.value.length;if(!n)return;const i=e%n;e<0?z.value=0:z.value=i}C(q,()=>{if(q.value){const e=V.value;switch(e.endEffect){case"continue":break;case"restart":Y();break;case"stop":E();break;case"startNext":{fe(),Y();break}}et(e)}});C(Ze,e=>{const t=V.value,n=t.soundWarning,i=pe(t.duration*1e3);n&&T.value&&e!==i&&Ke()});function fe(){const t=y.value.indexOf(V.value);me(t+1)}function et(e){e.activateSound&&Qe(),e.activateVibration&&tt()}function X(){if(!T.value)return;const e=performance.now(),t=e-J;J=e,N.value+=t;const n=ve.value;n<re&&n>=0&&setTimeout(X,n)}function A(){N.value=0}function U(){J=performance.now(),clearInterval(B.value),be.request("screen"),B.value=setInterval(X,re)}function Y(){A(),U()}function E(){clearInterval(B.value),B.value=0,X(),be.release()}const{vibrate:tt,isSupported:Z}=ze({pattern:[300,100,300,100,300]}),be=Ie(Je()),nt={key:0,class:"sign"},ot={key:1,class:"double-digits"},at={key:2,class:"separator"},it={class:"double-digits"},st={class:"double-digits"},lt=w({__name:"ChronometerDisplay",props:{value:{},duration:{},warn:{type:Boolean}},setup(e){const t=e;function n(u){return u.toString(10).padStart(2,"0")}const i=p(()=>Math.abs(t.value)),o=p(()=>{const u=i.value,v=Math.floor(u/3600);return n(v)}),a=p(()=>{const u=i.value,v=Math.floor(u/60)%60;return n(v)}),r=p(()=>{const v=i.value%60;return n(v)}),l=p(()=>t.duration>=3600||o.value!=="00"),s=p(()=>!!t.warn&&!q.value&&t.value<=10);return(u,v)=>(f(),_("div",{class:D(["chronometer-display",{timeout:c(q),running:c(T),warning:s.value}])},[u.value<0?(f(),_("div",nt," - ")):S("",!0),l.value?(f(),_("div",ot,m(o.value),1)):S("",!0),l.value?(f(),_("div",at," : ")):S("",!0),d("div",it,m(a.value),1),v[0]||(v[0]=d("div",{class:"separator"}," : ",-1)),d("div",st,m(r.value),1)],2))}}),ee=R(lt,[["__scopeId","data-v-ef7215f4"]]),ut={class:"period-name"},rt={class:"period-actions"},ct=w({__name:"ChronometerPlayer",setup(e){function t(){T.value?E():U()}function n(){E(),A(),fe()}return(i,o)=>(f(),_("div",{class:"chronometer-player",onClick:t},[b(ee,{class:"time-left",value:c(Ye),duration:c(V).duration,warn:""},null,8,["value","duration"]),b(ee,{class:"time-spent",value:c(de),duration:c(V).duration},null,8,["value","duration"]),d("div",ut,m(c(V).name),1),d("aside",rt,[c(T)?(f(),_("button",{key:0,class:"btn-transparent btn-small action",onClick:o[0]||(o[0]=I((...a)=>c(E)&&c(E)(...a),["stop","prevent"]))},[b(M,{icon:"pause"})])):S("",!0),c(T)?S("",!0):(f(),_("button",{key:1,class:"btn-transparent btn-small action",onClick:o[1]||(o[1]=I((...a)=>c(U)&&c(U)(...a),["stop","prevent"]))},[b(M,{icon:"play"})])),d("button",{class:"btn-transparent btn-small action",onClick:o[2]||(o[2]=I((...a)=>c(A)&&c(A)(...a),["stop","prevent"]))},[b(M,{icon:"restart"})]),c(y).length>1?(f(),_("button",{key:2,class:"btn-transparent btn-small action",onClick:I(n,["stop","prevent"])},[b(M,{icon:"next"})])):S("",!0)])]))}}),dt=R(ct,[["__scopeId","data-v-f5aaae7a"]]),vt=["disabled"],pt=w({__name:"ConfirmButton",props:{disabled:{type:Boolean},icon:{},message:{},duration:{},position:{}},emits:["click"],setup(e,{emit:t}){const n=e,i=t,o=g(0),a=p(()=>o.value!==0),r=p(()=>n.position||"top");function l(){o.value?i("click"):o.value=setTimeout(()=>{o.value=0},n.duration??2e3)}return(s,u)=>(f(),_("button",{class:D(["confirm-button",{active:a.value}]),disabled:s.disabled,onClick:I(l,["stop"])},[b(M,{icon:s.icon??"delete"},null,8,["icon"]),b(Me,null,{default:Te(()=>[a.value?(f(),_("div",{key:0,class:D(["tooltip",r.value])},m(s.message),3)):S("",!0)]),_:1})],10,vt))}}),mt=R(pt,[["__scopeId","data-v-afc95b1b"]]),ft=["min","max"],F=w({__name:"NumberSelection",props:Pe({min:{default:0},max:{default:60}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=te(e,"modelValue");return(n,i)=>$((f(),_("input",{type:"number","onUpdate:modelValue":i[0]||(i[0]=o=>t.value=o),min:n.min,max:n.max},null,8,ft)),[[ne,t.value]])}}),bt={class:"duration-editor"},_t=w({__name:"DurationEditor",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(e){const t=te(e,"modelValue"),n=g(0),i=g(0),o=g(0);return C(t,(a=0)=>{o.value=a%60,i.value=Math.floor(a/60)%60,n.value=Math.floor(a/3600)},{immediate:!0}),C([n,i,o],()=>{t.value=n.value*3600+i.value*60+o.value}),(a,r)=>(f(),_("span",bt,[b(F,{modelValue:n.value,"onUpdate:modelValue":r[0]||(r[0]=l=>n.value=l),max:24},null,8,["modelValue"]),r[3]||(r[3]=k(" : ")),b(F,{modelValue:i.value,"onUpdate:modelValue":r[1]||(r[1]=l=>i.value=l),max:59},null,8,["modelValue"]),r[4]||(r[4]=k(" : ")),b(F,{modelValue:o.value,"onUpdate:modelValue":r[2]||(r[2]=l=>o.value=l),max:59},null,8,["modelValue"])]))}}),ht={class:"period-name"},yt={class:"period-duration"},gt={class:"period-action"},Vt={value:"stop"},kt={value:"startNext"},Ct={value:"restart"},wt={value:"continue"},xt={class:"period-options"},St=["disabled"],$t=["disabled"],It=["disabled"],Mt=w({__name:"EditPeriod",props:{periodIndex:{},alone:{type:Boolean}},emits:["active"],setup(e,{emit:t}){const{t:n}=K(),i=e,o=t,a=g({...H}),r=p(()=>!0);return C(()=>i.periodIndex,()=>{const l=i.periodIndex,s=y.value[l];if(s){a.value={...s};return}a.value={...H,name:`period ${l+1}`,id:oe()}},{immediate:!0}),C(a,l=>{Q(i.periodIndex,l)},{deep:!0}),(l,s)=>(f(),_("div",{class:"edit-timer",onClick:s[7]||(s[7]=I(u=>o("active"),["self"]))},[d("label",ht,[k(m(c(n)("label.periodName"))+" ",1),$(d("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=u=>a.value.name=u)},null,512),[[ne,a.value.name]])]),d("label",yt,[k(m(c(n)("label.periodDuration"))+" ",1),b(_t,{modelValue:a.value.duration,"onUpdate:modelValue":s[1]||(s[1]=u=>a.value.duration=u)},null,8,["modelValue"])]),d("label",gt,[k(m(c(n)("label.periodAction"))+" ",1),$(d("select",{"onUpdate:modelValue":s[2]||(s[2]=u=>a.value.endEffect=u)},[d("option",Vt,m(c(n)("chronometer.actionStop")),1),d("option",kt,m(c(n)("chronometer.actionStartNext")),1),d("option",Ct,m(c(n)("chronometer.actionRepeat")),1),d("option",wt,m(c(n)("chronometer.actionContinue")),1)],512),[[Re,a.value.endEffect]])]),d("fieldset",xt,[d("legend",null,m(c(n)("chronometer.warningTitle")),1),d("label",null,[$(d("input",{type:"checkbox","onUpdate:modelValue":s[3]||(s[3]=u=>a.value.activateSound=u)},null,512),[[O,a.value.activateSound]]),k(" "+m(c(n)("chronometer.activateSound")),1)]),d("label",{disabled:!c(Z)},[$(d("input",{type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=u=>a.value.activateVibration=u),disabled:!a.value.activateVibration&&!r.value},null,8,$t),[[O,a.value.activateVibration]]),k(" "+m(c(n)("chronometer.activateVibration")),1)],8,St),d("label",{disabled:!c(Z)},[$(d("input",{type:"checkbox","onUpdate:modelValue":s[5]||(s[5]=u=>a.value.soundWarning=u)},null,512),[[O,a.value.soundWarning]]),k(" "+m(c(n)("chronometer.activateBeepWarning")),1)],8,It)]),b(mt,{class:"period-delete btn-small",disabled:l.alone,message:c(n)("chronometer.deletePeriodConfirm"),position:"left",onClick:s[6]||(s[6]=u=>c(Xe)(l.periodIndex))},null,8,["disabled","message"])]))}}),Tt=R(Mt,[["__scopeId","data-v-2ac2962a"]]),Pt={class:"chronometer-editor"},Rt=w({__name:"TimerTool",setup(e){const{t}=K();function n(){Q(-1)}return(i,o)=>(f(),_("main",Pt,[(f(!0),_(Ee,null,Le(c(y),(a,r)=>(f(),We(Tt,{class:D({active:a.id===c(V).id}),"period-index":r,alone:c(y).length===1,key:`edit-period-${a.id}`,onActive:l=>c(me)(r)},null,8,["class","period-index","alone","onActive"]))),128)),d("button",{class:"primary-btn",onClick:n},[b(M,{icon:"add"}),k(" "+m(c(t)("chronometer.addPeriod")),1)])]))}}),Et=R(Rt,[["__scopeId","data-v-c3c99c2b"]]),Lt={class:"container"},Wt=w({__name:"ChronometerView",setup(e){const{t}=K();return(n,i)=>(f(),_("div",Lt,[d("h1",null,m(c(t)("chronometer.settingsTitle")),1),b(dt),b(Et)]))}}),Nt=R(Wt,[["__scopeId","data-v-c7675194"]]);export{Nt as default};
