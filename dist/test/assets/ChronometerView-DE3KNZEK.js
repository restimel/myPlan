import{t as ge,r as _e,a as E,c as ye,s as W,i as Ve,w as y,b as Ee,d as Q,g as Be,o as Ce,e as A,f as ke,h as Se,u as c,j as we,l as xe,k as Ie,m as k,n as h,p as M,q as x,v as d,x as f,y as m,_ as $,z as Te,A as p,B as T,M as w,T as We,C as $e,D as Pe,E as ae,F as I,G as ie,H as V,I as Z,J as Qe,K as F,L as Me,N as Re,O as Le}from"./index-Bm32arTH.js";const Ne="data:video/webm;base64,GkXfowEAAAAAAAAQQoKFd2VibQBCh4ECQoWBAhhTgGcBAAAAAAACNxFNm3QBAAAAAAAAjE27AQAAAAAAABJTq4QVSalmU6yIAAAAAAAAAJhNuwEAAAAAAAASU6uEFlSua1OsiAAAAAAAAAEF7JoBAAAAAAAAElOrhBBDp3BTrIj//////////027AQAAAAAAABJTq4QcU7trU6yIAAAAAAAAAg/smgEAAAAAAAASU6uEElTDZ1OsiP//////////FUmpZgEAAAAAAABhKtexgw9CQESJiECMOH9XLeQ/TYClR1N0cmVhbWVyIG1hdHJvc2thbXV4IHZlcnNpb24gMS4yNC4yAFdBmUdTdHJlYW1lciBNYXRyb3NrYSBtdXhlcgBEYYgK3hOVtIx2IBZUrmsBAAAAAAAAV64BAAAAAAAATteBAYOBAXPFiEJJy6eyodjgU26GVmlkZW8A4AEAAAAAAAAjsIETuoEQmoECVbABAAAAAAAAEFW5gQFVsYEGVbqBBlW7gQaGhlZfVlA4AB9DtnUBAAAAAAAAm+eBFaOjgQABgBACAJ0BKhMAEAAQRwiFhYiZhIgCAgAJEeuA/v9vLACjlYEAIgCxAQBBEBAAGAAYWC/0AAhAAKOVgQBEALEBAEEQEAAYABhYL/QACEAAo5WBAGcAsQEAQRAQABgAGFgv9AAIQACjlYEAiQCxAQBBEBAAGAAYWC/0AAhAAKOVgQOIALEBAEEQEAAYABhYL/QACEAAHFO7awEAAAAAAAAcuwEAAAAAAAATs4EVtwEAAAAAAAAH94EB8YIBaA==";function X(){return Math.round(Math.random()*2**50)}function j(e){return Be()?(Ce(e),!0):!1}const R=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Ue=Object.prototype.toString,Oe=e=>Ue.call(e)==="[object Object]",Ye=()=>{};function Fe(...e){if(e.length!==1)return ge(...e);const t=e[0];return typeof t=="function"?_e(ye(()=>({get:t,set:Ye}))):E(t)}function D(e){return Array.isArray(e)?e:[e]}function De(e,t=1e3,n={}){const{immediate:a=!0,immediateCallback:i=!1}=n;let o=null;const u=W(!1);function s(){o&&(clearInterval(o),o=null)}function l(){u.value=!1,s()}function r(){const v=Q(t);v<=0||(u.value=!0,i&&e(),s(),u.value&&(o=setInterval(e,v)))}if(a&&R&&r(),Ve(t)||typeof t=="function"){const v=y(t,()=>{u.value&&R&&r()});j(v)}return j(l),{isActive:Ee(u),pause:l,resume:r}}function Ge(e,t,n){return y(e,t,{...n,immediate:!0})}function je(e,t,n){return y(e,(i,o,u)=>{i&&t(i,o,u)},{...n,once:!1})}const Je=R?window:void 0,se=R?window.document:void 0,le=R?window.navigator:void 0;function qe(e){var t;const n=Q(e);return(t=n==null?void 0:n.$el)!=null?t:n}function ue(...e){const t=[],n=()=>{t.forEach(s=>s()),t.length=0},a=(s,l,r,v)=>(s.addEventListener(l,r,v),()=>s.removeEventListener(l,r,v)),i=A(()=>{const s=D(Q(e[0])).filter(l=>l!=null);return s.every(l=>typeof l!="string")?s:void 0}),o=Ge(()=>{var s,l;return[(l=(s=i.value)==null?void 0:s.map(r=>qe(r)))!=null?l:[Je].filter(r=>r!=null),D(Q(i.value?e[1]:e[0])),D(c(i.value?e[2]:e[1])),Q(i.value?e[3]:e[2])]},([s,l,r,v])=>{if(n(),!(s!=null&&s.length)||!(l!=null&&l.length)||!(r!=null&&r.length))return;const g=Oe(v)?{...v}:v;t.push(...s.flatMap(S=>l.flatMap(be=>r.map(he=>a(S,be,he,g)))))},{flush:"post"}),u=()=>{o(),n()};return j(n),u}function He(){const e=W(!1),t=Se();return t&&ke(()=>{e.value=!0},t),e}function re(e){const t=He();return A(()=>(t.value,!!e()))}function Ke(e={}){const{document:t=se}=e;if(!t)return W("visible");const n=W(t.visibilityState);return ue(t,"visibilitychange",()=>{n.value=t.visibilityState},{passive:!0}),n}function Ze(e){const{pattern:t=[],interval:n=0,navigator:a=le}=e||{},i=re(()=>typeof a<"u"&&"vibrate"in a),o=Fe(t);let u;const s=(r=o.value)=>{i.value&&a.vibrate(r)},l=()=>{i.value&&a.vibrate(0),u==null||u.pause()};return n>0&&(u=De(s,n,{immediate:!1,immediateCallback:!1})),{isSupported:i,pattern:t,intervalControls:u,vibrate:s,stop:l}}function Xe(e={}){const{navigator:t=le,document:n=se}=e,a=W(!1),i=W(null),o=Ke({document:n}),u=re(()=>t&&"wakeLock"in t),s=A(()=>!!i.value&&o.value==="visible");u.value&&(ue(i,"release",()=>{var g,S;a.value=(S=(g=i.value)==null?void 0:g.type)!=null?S:!1},{passive:!0}),je(()=>o.value==="visible"&&(n==null?void 0:n.visibilityState)==="visible"&&a.value,g=>{a.value=!1,l(g)}));async function l(g){var S;await((S=i.value)==null?void 0:S.release()),i.value=u.value?await t.wakeLock.request(g):null}async function r(g){o.value==="visible"?await l(g):a.value=g}async function v(){a.value=!1;const g=i.value;i.value=null,await(g==null?void 0:g.release())}return{sentinel:i,isSupported:u,isActive:s,request:r,forceRequest:l,release:v}}function ze(){ce(1200,300,.4)}function et(){ce(1200,1e3,.6)}function ce(e=1e3,t=500,n=.2){const a=new(window.AudioContext||window.webkitAudioContext),i=a.createOscillator(),o=a.createGain();i.connect(o),o.connect(a.destination),i.type="sine",i.frequency.value=e,o.gain.value=n,i.start(),i.stop(a.currentTime+t/1e3)}const de=200,z="default period",_={id:0,name:z,duration:360,endEffect:"stop",activateSound:!0,activateVibration:!0,soundWarning:!0},b=E([]);Y(-1);const tt=A(()=>{const e=b.value;if(e.length>1)return!1;const t=e[0];return!(!/^period \d+$/.test(t.name)||t.duration!==_.duration||t.endEffect!==_.endEffect||t.activateSound!==_.activateSound||t.activateVibration!==_.activateVibration||t.soundWarning!==_.soundWarning)});function nt(e,t=b.value.length){return e||(e={..._}),e.id||(e.id=X()),(!e.name||e.name===z)&&(e.name=`period ${t+1}`),(typeof e.duration!="number"||e.duration<=0)&&(e.duration=_.duration),e.endEffect||(e.endEffect=_.endEffect),typeof e.activateSound!="boolean"&&(e.activateSound=_.activateSound),typeof e.activateVibration!="boolean"&&(e.activateVibration=_.activateVibration),typeof e.soundWarning!="boolean"&&(e.soundWarning=_.soundWarning),e}function ot(){const e=xe();e&&(b.value=e.map(nt)),y(b,t=>{Ie(t)},{deep:!0})}ot();function Y(e,t=_){const n=b.value,a={...t};return e>=0&&e<n.length?(n[e]=a,b.value=n,e):(a.id=X(),a.name===z&&(a.name=`period ${n.length+1}`),n.push(a),b.value=n,n.length-1)}function at(e){const t=b.value;return e>=0&&e<t.length?(t.splice(e,1),b.value=t,!0):!1}function ne(){b.value=[],Y(-1)}const J=E(0),B=A(()=>b.value[J.value]),C=A(()=>L.value!==0),N=E(0),ve=A(()=>Math.floor(N.value/1e3)),L=E(0);let q=performance.now();const Ae=A(()=>{const e=N.value;return B.value.duration*1e3-e}),it=A(()=>{const e=ve.value;return B.value.duration-e}),O=A(()=>{const e=B.value.duration*1e3;return N.value>=e}),st=A(()=>{const e=Ae.value;return fe(e)});function fe(e){return e>6e4?60:e>1e4?10:e>0?Math.floor(e/1e3):0}function ee(e){const n=b.value.length;if(!n)return;const a=e%n;e<0?J.value=0:J.value=a}y(O,()=>{if(O.value&&C.value){const e=B.value;switch(e.endEffect){case"continue":break;case"restart":K();break;case"stop":P();break;case"startNext":{pe(),K();break}}lt(e)}});y(st,e=>{const t=B.value,n=t.soundWarning&&t.activateSound,a=fe(t.duration*1e3);n&&C.value&&e!==a&&ze()});function pe(){const t=b.value.indexOf(B.value);ee(t+1)}function lt(e){e.activateSound&&et(),e.activateVibration&&ut()}function te(){if(!C.value)return;const e=performance.now(),t=e-q;q=e,N.value+=t;const n=Ae.value;n<de&&n>=0&&setTimeout(te,n)}function H(){N.value=0}function U(){q=performance.now(),clearInterval(L.value),me.request("screen"),L.value=setInterval(te,de)}function K(){H(),U()}function P(){clearInterval(L.value),L.value=0,te(),me.release()}const{vibrate:ut,isSupported:rt}=Ze({pattern:[300,100,300,100,300]}),me=we(Xe()),ct={key:0,class:"sign"},dt={key:1,class:"double-digits"},vt={key:2,class:"separator"},At={class:"double-digits"},ft={class:"double-digits"},pt=k({__name:"ChronometerDisplay",props:{value:{},duration:{},warn:{type:Boolean}},setup(e){const t=e;function n(r){return r.toString(10).padStart(2,"0")}const a=A(()=>Math.abs(t.value)),i=A(()=>{const r=a.value,v=Math.floor(r/3600);return n(v)}),o=A(()=>{const r=a.value,v=Math.floor(r/60)%60;return n(v)}),u=A(()=>{const v=a.value%60;return n(v)}),s=A(()=>t.duration>=3600||i.value!=="00"),l=A(()=>!!t.warn&&!O.value&&t.value<=10);return(r,v)=>(m(),h("div",{class:M(["chronometer-display",{timeout:c(O),running:c(C),warning:l.value}])},[r.value<0?(m(),h("div",ct," - ")):x("",!0),s.value?(m(),h("div",dt,f(i.value),1)):x("",!0),s.value?(m(),h("div",vt," : ")):x("",!0),d("div",At,f(o.value),1),v[0]||(v[0]=d("div",{class:"separator"}," : ",-1)),d("div",ft,f(u.value),1)],2))}}),oe=$(pt,[["__scopeId","data-v-ef7215f4"]]),mt={class:"period-name"},bt={class:"period-actions"},ht=k({__name:"ChronometerPlayer",setup(e){const t=Te("awakeVideo");y(C,o=>{var u,s;o?(u=t.value)==null||u.play():(s=t.value)==null||s.pause()});function n(){C.value?P():U()}function a(){const o=C.value;P(),H(),pe(),o&&K()}function i(){ee(0),H()}return(o,u)=>(m(),h("div",{class:"chronometer-player",onClick:n},[d("video",{class:"keep-awake-video",src:Ne,loop:"",controls:!1,ref_key:"awakeVideo",ref:t},null,512),p(oe,{class:"time-left",value:c(it),duration:c(B).duration,warn:""},null,8,["value","duration"]),p(oe,{class:"time-spent",value:c(ve),duration:c(B).duration},null,8,["value","duration"]),d("div",mt,f(c(B).name),1),d("aside",bt,[c(C)?(m(),h("button",{key:0,class:"btn-transparent btn-small action",onClick:u[0]||(u[0]=T((...s)=>c(P)&&c(P)(...s),["stop","prevent"]))},[p(w,{icon:"pause"})])):x("",!0),c(C)?x("",!0):(m(),h("button",{key:1,class:"btn-transparent btn-small action",onClick:u[1]||(u[1]=T((...s)=>c(U)&&c(U)(...s),["stop","prevent"]))},[p(w,{icon:"play"})])),d("button",{class:"btn-transparent btn-small action",onClick:T(i,["stop","prevent"])},[p(w,{icon:"restart"})]),c(b).length>1?(m(),h("button",{key:2,class:"btn-transparent btn-small action",onClick:T(a,["stop","prevent"])},[p(w,{icon:"next"})])):x("",!0)])]))}}),gt=$(ht,[["__scopeId","data-v-c8e0d222"]]),_t=["disabled"],yt=k({__name:"ConfirmButton",props:{disabled:{type:Boolean},icon:{},message:{},duration:{},position:{}},emits:["click"],setup(e,{emit:t}){const n=e,a=t,i=E(0),o=A(()=>i.value!==0),u=A(()=>n.position||"top");function s(){i.value?a("click"):i.value=setTimeout(()=>{i.value=0},n.duration??2e3)}return(l,r)=>(m(),h("button",{class:M(["confirm-button",{active:o.value}]),disabled:l.disabled,onClick:T(s,["stop"])},[p(w,{icon:l.icon??"delete"},null,8,["icon"]),p(We,null,{default:$e(()=>[o.value?(m(),h("div",{key:0,class:M(["tooltip",u.value])},f(l.message),3)):x("",!0)]),_:1})],10,_t))}}),Vt=$(yt,[["__scopeId","data-v-afc95b1b"]]),Et=["min","max"],G=k({__name:"NumberSelection",props:Pe({min:{default:0},max:{default:60}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=ae(e,"modelValue");return(n,a)=>I((m(),h("input",{type:"number","onUpdate:modelValue":a[0]||(a[0]=i=>t.value=i),min:n.min,max:n.max},null,8,Et)),[[ie,t.value]])}}),Bt={class:"duration-editor"},Ct=k({__name:"DurationEditor",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(e){const t=ae(e,"modelValue"),n=E(0),a=E(0),i=E(0);return y(t,(o=0)=>{i.value=o%60,a.value=Math.floor(o/60)%60,n.value=Math.floor(o/3600)},{immediate:!0}),y([n,a,i],()=>{t.value=n.value*3600+a.value*60+i.value}),(o,u)=>(m(),h("span",Bt,[p(G,{modelValue:n.value,"onUpdate:modelValue":u[0]||(u[0]=s=>n.value=s),max:24},null,8,["modelValue"]),u[3]||(u[3]=V(" : ")),p(G,{modelValue:a.value,"onUpdate:modelValue":u[1]||(u[1]=s=>a.value=s),max:59},null,8,["modelValue"]),u[4]||(u[4]=V(" : ")),p(G,{modelValue:i.value,"onUpdate:modelValue":u[2]||(u[2]=s=>i.value=s),max:59},null,8,["modelValue"])]))}}),kt={class:"period-name"},St={class:"period-duration"},wt={class:"period-action"},xt={value:"stop"},It={value:"startNext"},Tt={value:"restart"},Wt={value:"continue"},$t={class:"period-options"},Pt=["disabled"],Qt=["disabled"],Mt=k({__name:"EditPeriod",props:{periodIndex:{},alone:{type:Boolean}},emits:["active"],setup(e,{emit:t}){const{t:n}=Z(),a=e,i=t,o=E({..._}),u=A(()=>!0);return y(()=>a.periodIndex,()=>{const s=a.periodIndex,l=b.value[s];if(l){o.value={...l};return}o.value={..._,name:`period ${s+1}`,id:X()}},{immediate:!0}),y(()=>o.value.soundWarning,s=>{s&&(o.value.activateSound=!0)}),y(o,s=>{Y(a.periodIndex,s)},{deep:!0}),(s,l)=>(m(),h("div",{class:"edit-timer",onClick:l[7]||(l[7]=T(r=>i("active"),["self"]))},[d("label",kt,[V(f(c(n)("label.periodName"))+" ",1),I(d("input",{type:"text","onUpdate:modelValue":l[0]||(l[0]=r=>o.value.name=r)},null,512),[[ie,o.value.name]])]),d("label",St,[V(f(c(n)("label.periodDuration"))+" ",1),p(Ct,{modelValue:o.value.duration,"onUpdate:modelValue":l[1]||(l[1]=r=>o.value.duration=r)},null,8,["modelValue"])]),d("label",wt,[V(f(c(n)("label.periodAction"))+" ",1),I(d("select",{"onUpdate:modelValue":l[2]||(l[2]=r=>o.value.endEffect=r)},[d("option",xt,f(c(n)("chronometer.actionStop")),1),d("option",It,f(c(n)("chronometer.actionStartNext")),1),d("option",Tt,f(c(n)("chronometer.actionRepeat")),1),d("option",Wt,f(c(n)("chronometer.actionContinue")),1)],512),[[Qe,o.value.endEffect]])]),d("fieldset",$t,[d("legend",null,f(c(n)("chronometer.warningTitle")),1),d("label",{disabled:!c(rt)},[I(d("input",{type:"checkbox","onUpdate:modelValue":l[3]||(l[3]=r=>o.value.activateVibration=r),disabled:!o.value.activateVibration&&!u.value},null,8,Qt),[[F,o.value.activateVibration]]),V(" "+f(c(n)("chronometer.activateVibration")),1)],8,Pt),d("label",null,[I(d("input",{type:"checkbox","onUpdate:modelValue":l[4]||(l[4]=r=>o.value.activateSound=r)},null,512),[[F,o.value.activateSound]]),V(" "+f(c(n)("chronometer.activateSound")),1)]),d("label",{class:M({disabled:!o.value.activateSound})},[I(d("input",{type:"checkbox","onUpdate:modelValue":l[5]||(l[5]=r=>o.value.soundWarning=r)},null,512),[[F,o.value.soundWarning]]),V(" "+f(c(n)("chronometer.activateBeepWarning")),1)],2)]),p(Vt,{class:"period-delete btn-small",disabled:s.alone,message:c(n)("chronometer.deletePeriodConfirm"),position:"left",onClick:l[6]||(l[6]=r=>c(at)(s.periodIndex))},null,8,["disabled","message"])]))}}),Rt=$(Mt,[["__scopeId","data-v-9b42405d"]]),Lt={class:"chronometer-editor"},Nt=["disabled"],Ut=k({__name:"TimerTool",setup(e){const{t}=Z();function n(){Y(-1)}return(a,i)=>(m(),h("main",Lt,[(m(!0),h(Me,null,Re(c(b),(o,u)=>(m(),Le(Rt,{class:M({active:o.id===c(B).id}),"period-index":u,alone:c(b).length===1,key:`edit-period-${o.id}`,onActive:s=>c(ee)(u)},null,8,["class","period-index","alone","onActive"]))),128)),d("button",{class:"primary-btn",onClick:n},[p(w,{icon:"add"}),V(" "+f(c(t)("chronometer.addPeriod")),1)]),d("button",{class:"default-btn",disabled:c(tt),onClick:i[0]||(i[0]=(...o)=>c(ne)&&c(ne)(...o))},[p(w,{icon:"delete"}),V(" "+f(c(t)("chronometer.clearPeriods")),1)],8,Nt)]))}}),Ot=$(Ut,[["__scopeId","data-v-7127fb48"]]),Yt={class:"container editor-page"},Ft=k({__name:"ChronometerView",setup(e){const{t}=Z();return(n,a)=>(m(),h("div",Yt,[d("h1",null,f(c(t)("chronometer.settingsTitle")),1),p(gt),p(Ot)]))}}),Gt=$(Ft,[["__scopeId","data-v-3d8520aa"]]);export{Gt as default};
