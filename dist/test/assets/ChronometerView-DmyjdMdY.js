import{t as fe,r as be,a as V,c as _e,s as M,i as he,w as C,b as ye,d as R,g as Ve,o as ge,e as f,f as ke,h as Ce,u as c,j as Se,k as S,l as _,n as W,m as x,p as d,q as p,v as m,_ as P,x as b,y as $,M as I,T as we,z as xe,A as $e,B as ee,C as T,D as te,E as g,F as J,G as Ie,H as X,I as Me,J as Pe,K as Te}from"./index-BA3U-WzZ.js";function ne(){return Math.round(Math.random()*2**50)}function F(e){return Ve()?(ge(e),!0):!1}const B=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Ee=Object.prototype.toString,Re=e=>Ee.call(e)==="[object Object]",Le=()=>{};function Be(...e){if(e.length!==1)return fe(...e);const t=e[0];return typeof t=="function"?be(_e(()=>({get:t,set:Le}))):V(t)}function O(e){return Array.isArray(e)?e:[e]}function Ne(e,t=1e3,n={}){const{immediate:s=!0,immediateCallback:o=!1}=n;let a=null;const r=M(!1);function l(){a&&(clearInterval(a),a=null)}function i(){r.value=!1,l()}function u(){const v=R(t);v<=0||(r.value=!0,o&&e(),l(),r.value&&(a=setInterval(e,v)))}if(s&&B&&u(),he(t)||typeof t=="function"){const v=C(t,()=>{r.value&&B&&u()});F(v)}return F(i),{isActive:ye(r),pause:i,resume:u}}function Ae(e,t,n){return C(e,t,{...n,immediate:!0})}function De(e,t,n){return C(e,(o,a,r)=>{o&&t(o,a,r)},{...n,once:!1})}const Ue=B?window:void 0,oe=B?window.document:void 0,ae=B?window.navigator:void 0;function We(e){var t;const n=R(e);return(t=n==null?void 0:n.$el)!=null?t:n}function ie(...e){const t=[],n=()=>{t.forEach(l=>l()),t.length=0},s=(l,i,u,v)=>(l.addEventListener(i,u,v),()=>l.removeEventListener(i,u,v)),o=f(()=>{const l=O(R(e[0])).filter(i=>i!=null);return l.every(i=>typeof i!="string")?l:void 0}),a=Ae(()=>{var l,i;return[(i=(l=o.value)==null?void 0:l.map(u=>We(u)))!=null?i:[Ue].filter(u=>u!=null),O(R(o.value?e[1]:e[0])),O(c(o.value?e[2]:e[1])),R(o.value?e[3]:e[2])]},([l,i,u,v])=>{if(n(),!(l!=null&&l.length)||!(i!=null&&i.length)||!(u!=null&&u.length))return;const h=Re(v)?{...v}:v;t.push(...l.flatMap(w=>i.flatMap(pe=>u.map(me=>s(w,pe,me,h)))))},{flush:"post"}),r=()=>{a(),n()};return F(n),r}function qe(){const e=M(!1),t=Ce();return t&&ke(()=>{e.value=!0},t),e}function se(e){const t=qe();return f(()=>(t.value,!!e()))}function Oe(e={}){const{document:t=oe}=e;if(!t)return M("visible");const n=M(t.visibilityState);return ie(t,"visibilitychange",()=>{n.value=t.visibilityState},{passive:!0}),n}function je(e){const{pattern:t=[],interval:n=0,navigator:s=ae}=e||{},o=se(()=>typeof s<"u"&&"vibrate"in s),a=Be(t);let r;const l=(u=a.value)=>{o.value&&s.vibrate(u)},i=()=>{o.value&&s.vibrate(0),r==null||r.pause()};return n>0&&(r=Ne(l,n,{immediate:!1,immediateCallback:!1})),{isSupported:o,pattern:t,intervalControls:r,vibrate:l,stop:i}}function Fe(e={}){const{navigator:t=ae,document:n=oe}=e,s=M(!1),o=M(null),a=Oe({document:n}),r=se(()=>t&&"wakeLock"in t),l=f(()=>!!o.value&&a.value==="visible");r.value&&(ie(o,"release",()=>{var h,w;s.value=(w=(h=o.value)==null?void 0:h.type)!=null?w:!1},{passive:!0}),De(()=>a.value==="visible"&&(n==null?void 0:n.visibilityState)==="visible"&&s.value,h=>{s.value=!1,i(h)}));async function i(h){var w;await((w=o.value)==null?void 0:w.release()),o.value=r.value?await t.wakeLock.request(h):null}async function u(h){a.value==="visible"?await i(h):s.value=h}async function v(){s.value=!1;const h=o.value;o.value=null,await(h==null?void 0:h.release())}return{sentinel:o,isSupported:r,isActive:l,request:u,forceRequest:i,release:v}}const le=200,ue="default period",G={id:0,name:ue,duration:360,endEffect:"stop",activateSound:!0,activateVibration:!0},y=V([]);K(-1);function K(e,t=G){const n=y.value,s={...t};return e>=0&&e<n.length?(n[e]=s,y.value=n,e):(s.id=ne(),s.name===ue&&(s.name=`period ${n.length+1}`),n.push(s),y.value=n,n.length-1)}function Ge(e){const t=y.value;return e>=0&&e<t.length?(t.splice(e,1),y.value=t,!0):!1}const H=V(0),k=f(()=>y.value[H.value]),L=f(()=>N.value!==0),A=V(0),N=V(0);let z=performance.now();const re=f(()=>{const e=A.value;return k.value.duration*1e3-e}),q=f(()=>{const e=k.value.duration*1e3;return A.value>=e});function ce(e){const n=y.value.length;if(!n)return;const s=e%n;e<0?H.value=0:H.value=s}C(q,()=>{if(q.value){const e=k.value;switch(e.endEffect){case"continue":break;case"restart":Y();break;case"stop":E();break;case"startNext":{de(),Y();break}}He(e)}});function de(){const t=y.value.indexOf(k.value);ce(t+1)}function He(e){e.activateSound&&console.log("todo sound"),e.activateVibration&&ze()}function Q(){if(!L.value)return;const e=performance.now(),t=e-z;z=e,A.value+=t;const n=re.value;n<le&&n>=0&&setTimeout(Q,n)}function D(){A.value=0}function U(){z=performance.now(),clearInterval(N.value),ve.request("screen"),N.value=setInterval(Q,le)}function Y(){D(),U()}function E(){clearInterval(N.value),N.value=0,Q(),ve.release()}const{vibrate:ze,isSupported:Je}=je({pattern:[300,100,300,100,300]}),ve=Se(Fe()),Ke={key:0,class:"sign"},Qe={key:1,class:"double-digits"},Xe={key:2,class:"separator"},Ye={class:"double-digits"},Ze={class:"double-digits"},et=S({__name:"ChronometerDisplay",props:{value:{},duration:{},warn:{type:Boolean}},setup(e){const t=e;function n(u){return u.toString(10).padStart(2,"0")}const s=f(()=>Math.round(Math.abs(t.value)/1e3)),o=f(()=>{const u=s.value,v=Math.floor(u/3600);return n(v)}),a=f(()=>{const u=s.value,v=Math.floor(u/60)%60;return n(v)}),r=f(()=>{const v=s.value%60;return n(v)}),l=f(()=>t.duration>=36e5||o.value!=="00"),i=f(()=>!!t.warn&&!q.value&&t.value<=1e4);return(u,v)=>(m(),_("div",{class:W(["chronometer-display",{timeout:c(q),running:c(L),warning:i.value}])},[u.value<0?(m(),_("div",Ke," - ")):x("",!0),l.value?(m(),_("div",Qe,p(o.value),1)):x("",!0),l.value?(m(),_("div",Xe," : ")):x("",!0),d("div",Ye,p(a.value),1),v[0]||(v[0]=d("div",{class:"separator"}," : ",-1)),d("div",Ze,p(r.value),1)],2))}}),Z=P(et,[["__scopeId","data-v-00862ee1"]]),tt={class:"period-name"},nt={class:"period-actions"},ot=S({__name:"ChronometerPlayer",setup(e){function t(){L.value?E():U()}function n(){E(),D(),de()}return(s,o)=>(m(),_("div",{class:"chronometer-player",onClick:t},[b(Z,{class:"time-left",value:c(re),duration:c(k).duration*1e3,warn:""},null,8,["value","duration"]),b(Z,{class:"time-spent",value:c(A),duration:c(k).duration*1e3},null,8,["value","duration"]),d("div",tt,p(c(k).name),1),d("aside",nt,[c(L)?(m(),_("button",{key:0,class:"btn-transparent btn-small action",onClick:o[0]||(o[0]=$((...a)=>c(E)&&c(E)(...a),["stop","prevent"]))},[b(I,{icon:"pause"})])):x("",!0),c(L)?x("",!0):(m(),_("button",{key:1,class:"btn-transparent btn-small action",onClick:o[1]||(o[1]=$((...a)=>c(U)&&c(U)(...a),["stop","prevent"]))},[b(I,{icon:"play"})])),d("button",{class:"btn-transparent btn-small action",onClick:o[2]||(o[2]=$((...a)=>c(D)&&c(D)(...a),["stop","prevent"]))},[b(I,{icon:"restart"})]),c(y).length>1?(m(),_("button",{key:2,class:"btn-transparent btn-small action",onClick:$(n,["stop","prevent"])},[b(I,{icon:"next"})])):x("",!0)])]))}}),at=P(ot,[["__scopeId","data-v-693765e8"]]),it=["disabled"],st=S({__name:"ConfirmButton",props:{disabled:{type:Boolean},icon:{},message:{},duration:{},position:{}},emits:["click"],setup(e,{emit:t}){const n=e,s=t,o=V(0),a=f(()=>o.value!==0),r=f(()=>n.position||"top");function l(){o.value?s("click"):o.value=setTimeout(()=>{o.value=0},n.duration??2e3)}return(i,u)=>(m(),_("button",{class:W(["confirm-button",{active:a.value}]),disabled:i.disabled,onClick:$(l,["stop"])},[b(I,{icon:i.icon??"delete"},null,8,["icon"]),b(we,null,{default:xe(()=>[a.value?(m(),_("div",{key:0,class:W(["tooltip",r.value])},p(i.message),3)):x("",!0)]),_:1})],10,it))}}),lt=P(st,[["__scopeId","data-v-afc95b1b"]]),ut=["min","max"],j=S({__name:"NumberSelection",props:$e({min:{default:0},max:{default:60}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=ee(e,"modelValue");return(n,s)=>T((m(),_("input",{type:"number","onUpdate:modelValue":s[0]||(s[0]=o=>t.value=o),min:n.min,max:n.max},null,8,ut)),[[te,t.value]])}}),rt={class:"duration-editor"},ct=S({__name:"DurationEditor",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(e){const t=ee(e,"modelValue"),n=V(0),s=V(0),o=V(0);return C(t,(a=0)=>{o.value=a%60,s.value=Math.floor(a/60)%60,n.value=Math.floor(a/3600)},{immediate:!0}),C([n,s,o],()=>{t.value=n.value*3600+s.value*60+o.value}),(a,r)=>(m(),_("span",rt,[b(j,{modelValue:n.value,"onUpdate:modelValue":r[0]||(r[0]=l=>n.value=l),max:24},null,8,["modelValue"]),r[3]||(r[3]=g(" : ")),b(j,{modelValue:s.value,"onUpdate:modelValue":r[1]||(r[1]=l=>s.value=l),max:59},null,8,["modelValue"]),r[4]||(r[4]=g(" : ")),b(j,{modelValue:o.value,"onUpdate:modelValue":r[2]||(r[2]=l=>o.value=l),max:59},null,8,["modelValue"])]))}}),dt={class:"period-name"},vt={class:"period-duration"},pt={class:"period-action"},mt={value:"stop"},ft={value:"startNext"},bt={value:"restart"},_t={value:"continue"},ht={class:"period-options"},yt=["disabled"],Vt=["disabled"],gt=S({__name:"EditPeriod",props:{periodIndex:{},alone:{type:Boolean}},emits:["active"],setup(e,{emit:t}){const{t:n}=J(),s=e,o=t,a=V({...G}),r=f(()=>!0);return C(()=>s.periodIndex,()=>{const l=s.periodIndex,i=y.value[l];if(i){a.value={...i};return}a.value={...G,name:`period ${l+1}`,id:ne()}},{immediate:!0}),C(a,l=>{K(s.periodIndex,l)},{deep:!0}),(l,i)=>(m(),_("div",{class:"edit-timer",onClick:i[6]||(i[6]=$(u=>o("active"),["self"]))},[d("label",dt,[g(p(c(n)("label.periodName"))+" ",1),T(d("input",{type:"text","onUpdate:modelValue":i[0]||(i[0]=u=>a.value.name=u)},null,512),[[te,a.value.name]])]),d("label",vt,[g(p(c(n)("label.periodDuration"))+" ",1),b(ct,{modelValue:a.value.duration,"onUpdate:modelValue":i[1]||(i[1]=u=>a.value.duration=u)},null,8,["modelValue"])]),d("label",pt,[g(p(c(n)("label.periodAction"))+" ",1),T(d("select",{"onUpdate:modelValue":i[2]||(i[2]=u=>a.value.endEffect=u)},[d("option",mt,p(c(n)("chronometer.actionStop")),1),d("option",ft,p(c(n)("chronometer.actionStartNext")),1),d("option",bt,p(c(n)("chronometer.actionRepeat")),1),d("option",_t,p(c(n)("chronometer.actionContinue")),1)],512),[[Ie,a.value.endEffect]])]),d("fieldset",ht,[d("legend",null,p(c(n)("chronometer.warningTitle")),1),d("label",null,[T(d("input",{type:"checkbox","onUpdate:modelValue":i[3]||(i[3]=u=>a.value.activateSound=u)},null,512),[[X,a.value.activateSound]]),g(" "+p(c(n)("chronometer.activateSound")),1)]),d("label",{disabled:!c(Je)},[T(d("input",{type:"checkbox","onUpdate:modelValue":i[4]||(i[4]=u=>a.value.activateVibration=u),disabled:!a.value.activateVibration&&!r.value},null,8,Vt),[[X,a.value.activateVibration]]),g(" "+p(c(n)("chronometer.activateVibration")),1)],8,yt)]),b(lt,{class:"period-delete btn-small",disabled:l.alone,message:c(n)("chronometer.deletePeriodConfirm"),position:"left",onClick:i[5]||(i[5]=u=>c(Ge)(l.periodIndex))},null,8,["disabled","message"])]))}}),kt=P(gt,[["__scopeId","data-v-5a35c90f"]]),Ct={class:"chronometer-editor"},St=S({__name:"TimerTool",setup(e){const{t}=J();function n(){K(-1)}return(s,o)=>(m(),_("main",Ct,[(m(!0),_(Me,null,Pe(c(y),(a,r)=>(m(),Te(kt,{class:W({active:a.id===c(k).id}),"period-index":r,alone:c(y).length===1,key:`edit-period-${a.id}`,onActive:l=>c(ce)(r)},null,8,["class","period-index","alone","onActive"]))),128)),d("button",{class:"primary-btn",onClick:n},[b(I,{icon:"add"}),g(" "+p(c(t)("chronometer.addPeriod")),1)])]))}}),wt=P(St,[["__scopeId","data-v-c3c99c2b"]]),xt={class:"container"},$t=S({__name:"ChronometerView",setup(e){const{t}=J();return(n,s)=>(m(),_("div",xt,[d("h1",null,p(c(t)("chronometer.settingsTitle")),1),b(at),b(wt)]))}}),Mt=P($t,[["__scopeId","data-v-c7675194"]]);export{Mt as default};
