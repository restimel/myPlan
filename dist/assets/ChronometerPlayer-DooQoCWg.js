import{z as te,A as Ee,B as ye,C as we,D as Be,E as Ce,r as Q,G as Se,H as S,I as ke,h as y,J as Ve,K as ne,L as R,c as v,l as m,N as _e,O as Re,P as Te,d as oe,a as B,n as ae,f as T,k,t as M,o as C,_ as ie,Q as z,b as _,w as N,M as O,R as We}from"./index-DsAGCeld.js";const Ie="data:video/webm;base64,GkXfowEAAAAAAAAQQoKFd2VibQBCh4ECQoWBAhhTgGcBAAAAAAACNxFNm3QBAAAAAAAAjE27AQAAAAAAABJTq4QVSalmU6yIAAAAAAAAAJhNuwEAAAAAAAASU6uEFlSua1OsiAAAAAAAAAEF7JoBAAAAAAAAElOrhBBDp3BTrIj//////////027AQAAAAAAABJTq4QcU7trU6yIAAAAAAAAAg/smgEAAAAAAAASU6uEElTDZ1OsiP//////////FUmpZgEAAAAAAABhKtexgw9CQESJiECMOH9XLeQ/TYClR1N0cmVhbWVyIG1hdHJvc2thbXV4IHZlcnNpb24gMS4yNC4yAFdBmUdTdHJlYW1lciBNYXRyb3NrYSBtdXhlcgBEYYgK3hOVtIx2IBZUrmsBAAAAAAAAV64BAAAAAAAATteBAYOBAXPFiEJJy6eyodjgU26GVmlkZW8A4AEAAAAAAAAjsIETuoEQmoECVbABAAAAAAAAEFW5gQFVsYEGVbqBBlW7gQaGhlZfVlA4AB9DtnUBAAAAAAAAm+eBFaOjgQABgBACAJ0BKhMAEAAQRwiFhYiZhIgCAgAJEeuA/v9vLACjlYEAIgCxAQBBEBAAGAAYWC/0AAhAAKOVgQBEALEBAEEQEAAYABhYL/QACEAAo5WBAGcAsQEAQRAQABgAGFgv9AAIQACjlYEAiQCxAQBBEBAAGAAYWC/0AAhAAKOVgQOIALEBAEEQEAAYABhYL/QACEAAHFO7awEAAAAAAAAcuwEAAAAAAAATs4EVtwEAAAAAAAAH94EB8YIBaA==";function se(){return Math.round(Math.random()*2**50)}function F(e){return ye()?(we(e),!0):!1}const I=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const xe=Object.prototype.toString,Pe=e=>xe.call(e)==="[object Object]",Qe=()=>{};function Le(...e){if(e.length!==1)return Be(...e);const t=e[0];return typeof t=="function"?Ce(Se(()=>({get:t,set:Qe}))):Q(t)}function Y(e){return Array.isArray(e)?e:[e]}function Ne(e){return ne()}function Oe(e,t=!0,n){Ne()?te(e,n):t?e():Ee(e)}function Me(e,t=1e3,n={}){const{immediate:o=!0,immediateCallback:i=!1}=n;let c=null;const u=S(!1);function s(){c&&(clearInterval(c),c=null)}function l(){u.value=!1,s()}function r(){const A=R(t);A<=0||(u.value=!0,i&&e(),s(),u.value&&(c=setInterval(e,A)))}if(o&&I&&r(),ke(t)||typeof t=="function"){const A=y(t,()=>{u.value&&I&&r()});F(A)}return F(l),{isActive:Ve(u),pause:l,resume:r}}function Ye(e,t,n){return y(e,t,{...n,immediate:!0})}function Ge(e,t,n){return y(e,(i,c,u)=>{i&&t(i,c,u)},{...n,once:!1})}const j=I?window:void 0,ue=I?window.document:void 0,re=I?window.navigator:void 0;function V(e){var t;const n=R(e);return(t=n==null?void 0:n.$el)!=null?t:n}function ce(...e){const t=[],n=()=>{t.forEach(s=>s()),t.length=0},o=(s,l,r,A)=>(s.addEventListener(l,r,A),()=>s.removeEventListener(l,r,A)),i=v(()=>{const s=Y(R(e[0])).filter(l=>l!=null);return s.every(l=>typeof l!="string")?s:void 0}),c=Ye(()=>{var s,l;return[(l=(s=i.value)==null?void 0:s.map(r=>V(r)))!=null?l:[j].filter(r=>r!=null),Y(R(i.value?e[1]:e[0])),Y(m(i.value?e[2]:e[1])),R(i.value?e[3]:e[2])]},([s,l,r,A])=>{if(n(),!(s!=null&&s.length)||!(l!=null&&l.length)||!(r!=null&&r.length))return;const a=Pe(A)?{...A}:A;t.push(...s.flatMap(f=>l.flatMap(d=>r.map(p=>o(f,d,p,a)))))},{flush:"post"}),u=()=>{c(),n()};return F(n),u}function Fe(){const e=S(!1),t=ne();return t&&te(()=>{e.value=!0},t),e}function $(e){const t=Fe();return v(()=>(t.value,!!e()))}function De(e={}){const{document:t=ue}=e;if(!t)return S("visible");const n=S(t.visibilityState);return ce(t,"visibilitychange",()=>{n.value=t.visibilityState},{passive:!0}),n}function Ue(e,t,n={}){const{window:o=j,...i}=n;let c;const u=$(()=>o&&"ResizeObserver"in o),s=()=>{c&&(c.disconnect(),c=void 0)},l=v(()=>{const a=R(e);return Array.isArray(a)?a.map(f=>V(f)):[V(a)]}),r=y(l,a=>{if(s(),u.value&&o){c=new ResizeObserver(t);for(const f of a)f&&c.observe(f,i)}},{immediate:!0,flush:"post"}),A=()=>{s(),r()};return F(A),{isSupported:u,stop:A}}function He(e,t={width:0,height:0},n={}){const{window:o=j,box:i="content-box"}=n,c=v(()=>{var a,f;return(f=(a=V(e))==null?void 0:a.namespaceURI)==null?void 0:f.includes("svg")}),u=S(t.width),s=S(t.height),{stop:l}=Ue(e,([a])=>{const f=i==="border-box"?a.borderBoxSize:i==="content-box"?a.contentBoxSize:a.devicePixelContentBoxSize;if(o&&c.value){const d=V(e);if(d){const p=d.getBoundingClientRect();u.value=p.width,s.value=p.height}}else if(f){const d=Y(f);u.value=d.reduce((p,{inlineSize:w})=>p+w,0),s.value=d.reduce((p,{blockSize:w})=>p+w,0)}else u.value=a.contentRect.width,s.value=a.contentRect.height},n);Oe(()=>{const a=V(e);a&&(u.value="offsetWidth"in a?a.offsetWidth:t.width,s.value="offsetHeight"in a?a.offsetHeight:t.height)});const r=y(()=>V(e),a=>{u.value=a?t.width:0,s.value=a?t.height:0});function A(){l(),r()}return{width:u,height:s,stop:A}}function Je(e){const{pattern:t=[],interval:n=0,navigator:o=re}=e||{},i=$(()=>typeof o<"u"&&"vibrate"in o),c=Le(t);let u;const s=(r=c.value)=>{i.value&&o.vibrate(r)},l=()=>{i.value&&o.vibrate(0),u==null||u.pause()};return n>0&&(u=Me(s,n,{immediate:!1,immediateCallback:!1})),{isSupported:i,pattern:t,intervalControls:u,vibrate:s,stop:l}}function je(e={}){const{navigator:t=re,document:n=ue}=e,o=S(!1),i=S(null),c=De({document:n}),u=$(()=>t&&"wakeLock"in t),s=v(()=>!!i.value&&c.value==="visible");u.value&&(ce(i,"release",()=>{var a,f;o.value=(f=(a=i.value)==null?void 0:a.type)!=null?f:!1},{passive:!0}),Ge(()=>c.value==="visible"&&(n==null?void 0:n.visibilityState)==="visible"&&o.value,a=>{o.value=!1,l(a)}));async function l(a){var f;await((f=i.value)==null?void 0:f.release()),i.value=u.value?await t.wakeLock.request(a):null}async function r(a){c.value==="visible"?await l(a):o.value=a}async function A(){o.value=!1;const a=i.value;i.value=null,await(a==null?void 0:a.release())}return{sentinel:i,isSupported:u,isActive:s,request:r,forceRequest:l,release:A}}function $e(){le(1200,300,.4)}function qe(){le(1050,1e3,.6)}function le(e=1e3,t=500,n=.2){const o=new(window.AudioContext||window.webkitAudioContext),i=o.createOscillator(),c=o.createGain();i.connect(c),c.connect(o.destination),i.type="sine",i.frequency.value=e,c.gain.value=n,i.start(),i.stop(o.currentTime+t/1e3)}const Ae=200,Z=6e4,X=5e3,q="default period",b={id:0,name:q,duration:360,endEffect:"stop",activateSound:!0,activateVibration:!0,soundWarning:!0},h=Q([]);de(-1);const ft=v(()=>{const e=h.value;if(e.length>1)return!1;const t=e[0];return!(!/^period \d+$/.test(t.name)||t.duration!==b.duration||t.endEffect!==b.endEffect||t.activateSound!==b.activateSound||t.activateVibration!==b.activateVibration||t.soundWarning!==b.soundWarning)});function Ke(e,t=h.value.length){return e||(e={...b}),e.id||(e.id=se()),(!e.name||e.name===q)&&(e.name=`period ${t+1}`),(typeof e.duration!="number"||e.duration<=0)&&(e.duration=b.duration),e.endEffect||(e.endEffect=b.endEffect),typeof e.activateSound!="boolean"&&(e.activateSound=b.activateSound),typeof e.activateVibration!="boolean"&&(e.activateVibration=b.activateVibration),typeof e.soundWarning!="boolean"&&(e.soundWarning=b.soundWarning),e}function ze(){const e=Re();e&&(h.value=e.map(Ke)),y(h,t=>{Te(t)},{deep:!0})}ze();function de(e,t=b){const n=h.value,o={...t};return e>=0&&e<n.length?(n[e]=o,h.value=n,e):(o.id=se(),o.name===q&&(o.name=`period ${n.length+1}`),n.push(o),h.value=n,n.length-1)}function vt(e){const t=h.value;return e>=0&&e<t.length?(t.splice(e,1),h.value=t,!0):!1}function pt(){h.value=[],de(-1)}const D=Q(0),E=v(()=>h.value[D.value]),g=v(()=>x.value!==0),L=Q(0),fe=v(()=>Math.floor(L.value/1e3)),x=Q(0);let U=performance.now();const ve=v(()=>{const e=L.value;return E.value.duration*1e3-e}),Ze=v(()=>{const e=fe.value;return E.value.duration-e}),P=v(()=>{const e=E.value.duration*1e3;return L.value>=e}),pe=v(()=>{const e=ve.value;return me(e)});function me(e){return e>Z?Z/1e3:e>X?X/1e3:e>0?Math.floor(e/1e3):0}function he(e){const n=h.value.length;if(!n)return;const o=e%n;e<0?D.value=0:D.value=o}y(P,()=>{if(P.value&&g.value){const e=E.value;switch(e.endEffect){case"continue":break;case"restart":J();break;case"stop":W();break;case"startNext":{be(),J();break}}Xe(e)}});y(pe,e=>{const t=E.value,n=t.soundWarning&&t.activateSound,o=me(t.duration*1e3);n&&g.value&&e!==o&&$e()});function be(){const t=h.value.indexOf(E.value);he(t+1)}function Xe(e){e.activateSound&&qe(),e.activateVibration&&et()}function K(){if(!g.value)return;const e=performance.now(),t=e-U;U=e,L.value+=t;const n=ve.value,o=n-pe.value*1e3;o<Ae&&n>=0&&setTimeout(K,o)}function H(){L.value=0}function G(){U=performance.now(),clearInterval(x.value),ge.request("screen"),x.value=setInterval(K,Ae)}function J(){H(),G()}function W(){clearInterval(x.value),x.value=0,K(),ge.release()}const{vibrate:et,isSupported:mt}=Je({pattern:[300,100,300,100,300]}),ge=_e(je()),tt={key:0,class:"sign"},nt={key:1,class:"double-digits"},ot={key:2,class:"separator"},at={class:"double-digits"},it={class:"double-digits"},st=oe({__name:"ChronometerDisplay",props:{value:{},duration:{},warn:{type:Boolean}},setup(e){const t=e;function n(r){return r.toString(10).padStart(2,"0")}const o=v(()=>Math.abs(t.value)),i=v(()=>{const r=o.value,A=Math.floor(r/3600);return n(A)}),c=v(()=>{const r=o.value,A=Math.floor(r/60)%60;return n(A)}),u=v(()=>{const A=o.value%60;return n(A)}),s=v(()=>t.duration>=3600||i.value!=="00"),l=v(()=>!!t.warn&&!P.value&&t.value<=10);return(r,A)=>(C(),B("div",{class:ae(["chronometer-display",{timeout:m(P),running:m(g),warning:l.value}])},[r.value<0?(C(),B("div",tt," - ")):T("",!0),s.value?(C(),B("div",nt,M(i.value),1)):T("",!0),s.value?(C(),B("div",ot," : ")):T("",!0),k("div",at,M(c.value),1),A[0]||(A[0]=k("div",{class:"separator"}," : ",-1)),k("div",it,M(u.value),1)],2))}}),ee=ie(st,[["__scopeId","data-v-ef7215f4"]]),ut={class:"period-name"},rt={class:"period-actions"},ct=500,lt=5e3,At=oe({__name:"ChronometerPlayer",setup(e){We(d=>({"5aa65d02":c.value}));const t=z("awakeVideo"),n=z("chronometerPlayer"),{width:o,height:i}=He(n),c=v(()=>{const p=5*i.value/6;return p*1.4<o.value?`${p/2}px`:`${o.value/1.4/2}px`});let u=0;function s(){var d;clearTimeout(u),(d=t.value)==null||d.play(),u=setTimeout(l,ct)}function l(){var d;clearTimeout(u),(d=t.value)==null||d.pause(),u=setTimeout(s,lt)}function r(){var d;clearTimeout(u),(d=t.value)==null||d.pause(),u=0}y(g,d=>{d?s():r()});function A(){g.value?W():G()}function a(){const d=g.value;W(),H(),be(),d&&J()}function f(){he(0),H()}return(d,p)=>(C(),B("div",{class:ae(["chronometer-player",{timeout:m(P)}]),onClick:A,ref_key:"chronometerPlayer",ref:n},[k("video",{class:"keep-awake-video",src:Ie,muted:"",loop:"",controls:!1,ref_key:"awakeVideo",ref:t},null,512),_(ee,{class:"time-left",value:m(Ze),duration:m(E).duration,warn:""},null,8,["value","duration"]),_(ee,{class:"time-spent",value:m(fe),duration:m(E).duration},null,8,["value","duration"]),k("div",ut,M(m(E).name),1),k("aside",rt,[m(g)?(C(),B("button",{key:0,class:"btn-transparent btn-small action",onClick:p[0]||(p[0]=N((...w)=>m(W)&&m(W)(...w),["stop","prevent"]))},[_(O,{icon:"pause"})])):T("",!0),m(g)?T("",!0):(C(),B("button",{key:1,class:"btn-transparent btn-small action",onClick:p[1]||(p[1]=N((...w)=>m(G)&&m(G)(...w),["stop","prevent"]))},[_(O,{icon:"play"})])),k("button",{class:"btn-transparent btn-small action",onClick:N(f,["stop","prevent"])},[_(O,{icon:"restart"})]),m(h).length>1?(C(),B("button",{key:2,class:"btn-transparent btn-small action",onClick:N(a,["stop","prevent"])},[_(O,{icon:"next"})])):T("",!0)])],2))}}),ht=ie(At,[["__scopeId","data-v-86f1fa07"]]);export{ht as C,$e as a,qe as b,vt as c,b as d,pt as e,ft as f,se as g,E as h,mt as i,h as p,he as s,de as u,et as v};
